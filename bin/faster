#!/usr/bin/env node

var program  = require("commander"),
    config   = require("../lib/config").config;
    core     = require("../lib/core").core;

program
  .version(core.version)
  .option("-b, --build",  "build a deployable version")
  .option("-t, --target", "specify a different target directory")
  .option("-s, --source", "specify a different source directory")
  .parse(process.argv);

config.appdir = program.source || config.appdir;
config.pubdir = program.target || config.pubdir;

var preamble = function() {
  core.log();
  core.log(1, "Faster!");
  core.log(2, "Source:", config.appdir);
  core.log(2, "Target:", config.pubdir);
  core.log();
};

var devmode = function() {
  preamble();
  core.log(1, "Development mode!");
  core.regen_all();
  core.watch();
};

var build = function() {
  preamble();
  core.log(1, "Building site!");
  core.log();
  core.regen_all();
};

if(program.build) {
  build();
} else {
  devmode();
}
